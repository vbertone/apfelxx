//
// APFEL++ 2017
//
// Author: Valerio Bertone: valerio.bertone@cern.ch
//

#include "apfel/ogataquadrature.h"
#include "apfel/messages.h"
#include "apfel/distribution.h"
#include "apfel/set.h"
#include "apfel/doubleobject.h"

#include <cmath>
//#include <boost/math/special_functions/bessel.hpp>

namespace apfel
{
  /**
   * First 1000 zero's of the first-order Bessel functions J0 and J1
   * computed with Boost.
   */
  const std::vector<double> j0Zeros
  {
    2.404825557695773, 5.520078110286311, 8.653727912911013, 11.79153443901428,
    14.93091770848779, 18.07106396791092, 21.21163662987926, 24.3524715307493,
    27.49347913204025, 30.63460646843198, 33.77582021357357, 36.91709835366404,
    40.05842576462824, 43.19979171317673, 46.34118837166181, 49.48260989739781,
    52.624051841115,   55.76551075501998, 58.90698392608094, 62.04846919022717,
    65.18996480020687, 68.3314693298568,  71.47298160359374, 74.61450064370183,
    77.75602563038805, 80.89755587113763, 84.0390907769382,  87.18062984364116,
    90.32217263721049, 93.46371878194478, 96.60526795099626, 99.7468198586806,
    102.8883742541948, 106.0299309164516, 109.1714896498054, 112.3130502804949,
    115.4546126536669, 118.5961766308725, 121.737742087951,  124.8793089132329,
    128.0208770060083, 131.1624462752139, 134.3040166383055, 137.4455880202843,
    140.5871603528543, 143.7287335736897, 146.8703076257966, 150.0118824569548,
    153.1534580192279, 156.2950342685335, 159.4366111642632, 162.5781886689467,
    165.719766747955,  168.8613453692358, 172.0029245030782, 175.1445041219027,
    178.2860842000738, 181.427664713731,  184.5692456406387, 187.7108269600494,
    190.8524086525815, 193.9939907001091, 197.1355730856614, 200.2771557933324,
    203.4187388081986, 206.5603221162445, 209.7019057042941, 212.8434895599495,
    215.985073671534,  219.1266580280406, 222.2682426190843, 225.4098274348593,
    228.5514124660988, 231.6929977040385, 234.8345831403832, 237.9761687672757,
    241.117754577268,  244.2593405632957, 247.4009267186528, 250.54251303697,
    253.6840995121931, 256.8256861385644, 259.9672729106045, 263.1088598230955,
    266.2504468710659, 269.392034049776,  272.5336213547049, 275.6752087815374,
    278.8167963261531, 281.9583839846149, 285.0999717531595, 288.2415596281877,
    291.3831476062552, 294.524735684065,  297.666323858459,  300.8079121264111,
    303.9495004850206, 307.0910889315051, 310.232677463195,  313.3742660775279,
    316.5158547720429, 319.6574435443762, 322.7990323922555, 325.9406213134967,
    329.0822103059986, 332.2237993677396, 335.3653884967741, 338.5069776912285,
    341.6485669492981, 344.790156269244,  347.9317456493902, 351.0733350881206,
    354.2149245838764, 357.3565141351538, 360.4981037405011, 363.639693398517,
    366.7812831078483, 369.9228728671875, 373.0644626752713, 376.2060525308785,
    379.3476424328285, 382.4892323799793, 385.6308223712264, 388.7724124055006,
    391.9140024817674, 395.0555925990249, 398.1971827563028, 401.3387729526615,
    404.4803631871904, 407.6219534590069, 410.7635437672553, 413.9051341111063,
    417.0467244897553, 420.1883149024216, 423.3299053483481, 426.4714958267996,
    429.6130863370627, 432.7546768784446, 435.8962674502723, 439.0378580518924,
    442.1794486826699, 445.3210393419877, 448.462630029246,  451.6042207438617,
    454.7458114852677, 457.8874022529128, 461.0289930462604, 464.1705838647888,
    467.31217470799,   470.4537655753699, 473.5953564664471, 476.7369473807533,
    479.8785383178323, 483.0201292772397, 486.1617202585426, 489.3033112613194,
    492.444902285159,  495.5864933296609, 498.7280843944346, 501.8696754790994,
    505.0112665832841, 508.1528577066267, 511.294448848774,  514.4360400093816,
    517.5776311881133, 520.7192223846409, 523.8608135986445, 527.0024048298116,
    530.1439960778367, 533.2855873424221, 536.427178623277,  539.5687699201169,
    542.7103612326645, 545.8519525606483, 548.9935439038036, 552.1351352618713,
    555.2767266345982, 558.4183180217369, 561.5599094230457, 564.701500838288,
    567.8430922672325, 570.984683709653,  574.1262751653285, 577.2678666340424,
    580.409458115583,  583.5510496097432, 586.6926411163203, 589.8342326351157,
    592.9758241659354, 596.1174157085893, 599.2590072628911, 602.4005988286589,
    605.5421904057138, 608.6837819938813, 611.8253735929903, 614.9669652028729,
    618.108556823365,  621.2501484543054, 624.3917400955368, 627.5333317469042,
    630.6749234082564, 633.8165150794449, 636.9581067603241, 640.0996984507514,
    643.2412901505867, 646.382881859693,  649.5244735779357, 652.666065305183,
    655.8076570413053, 658.9492487861759, 662.09084053967,   665.2324323016657,
    668.3740240720429, 671.515615850684,  674.6572076374736, 677.7987994322984,
    680.9403912350472, 684.0819830456109, 687.223574863882,  690.3651666897557,
    693.5067585231285, 696.6483503638989, 699.7899422119673, 702.9315340672358,
    706.0731259296085, 709.2147177989908, 712.3563096752899, 715.4979015584149,
    718.6394934482762, 721.7810853447858, 724.9226772478572, 728.0642691574056,
    731.2058610733475, 734.3474529956007, 737.4890449240849, 740.6306368587203,
    743.7722287994293, 746.9138207461351, 750.0554126987624, 753.1970046572372,
    756.3385966214867, 759.4801885914389, 762.6217805670236, 765.7633725481713,
    768.9049645348141, 772.0465565268846, 775.1881485243169, 778.3297405270463,
    781.4713325350086, 784.6129245481411, 787.7545165663819, 790.8961085896701,
    794.0377006179459, 797.1792926511503, 800.3208846892252, 803.4624767321135,
    806.6040687797589, 809.7456608321061, 812.8872528891006, 816.0288449506887,
    819.1704370168175, 822.312029087435,  825.4536211624901, 828.595213241932,
    831.7368053257113, 834.8783974137789, 838.0199895060865, 841.1615816025867,
    844.3031737032327, 847.4447658079783, 850.5863579167782, 853.7279500295875,
    856.8695421463623, 860.011134267059,  863.1527263916347, 866.2943185200475,
    869.4359106522554, 872.5775027882178, 875.7190949278939, 878.8606870712442,
    882.0022792182293, 885.1438713688106, 888.2854635229497, 891.4270556806093,
    894.5686478417522, 897.7102400063417, 900.8518321743418, 903.993424345717,
    907.1350165204321, 910.2766086984528, 913.4182008797447, 916.5597930642743,
    919.7013852520085, 922.8429774429144, 925.9845696369598, 929.1261618341128,
    932.2677540343421, 935.4093462376167, 938.5509384439059, 941.6925306531796,
    944.8341228654079, 947.9757150805616, 951.1173072986116, 954.2588995195295,
    957.4004917432868, 960.5420839698558, 963.6836761992089, 966.825268431319,
    969.9668606661595, 973.1084529037037, 976.2500451439255, 979.3916373867992,
    982.5332296322995, 985.6748218804011, 988.8164141310792, 991.9580063843094,
    995.0995986400676, 998.2411908983298, 1001.382783159073, 1004.524375422272,
    1007.665967687907, 1010.807559955952, 1013.949152226387, 1017.090744499189,
    1020.232336774336, 1023.373929051806, 1026.515521331579, 1029.657113613632,
    1032.798705897946, 1035.9402981845,   1039.081890473273, 1042.223482764246,
    1045.365075057397, 1048.506667352709, 1051.648259650162, 1054.789851949736,
    1057.931444251412, 1061.073036555172, 1064.214628860998, 1067.356221168871,
    1070.497813478773, 1073.639405790686, 1076.780998104593, 1079.922590420477,
    1083.064182738319, 1086.205775058104, 1089.347367379814, 1092.488959703433,
    1095.630552028944, 1098.772144356331, 1101.913736685578, 1105.055329016669,
    1108.196921349589, 1111.338513684322, 1114.480106020853, 1117.621698359166,
    1120.763290699246, 1123.904883041079, 1127.04647538465,  1130.188067729945,
    1133.329660076948, 1136.471252425647, 1139.612844776027, 1142.754437128074,
    1145.896029481774, 1149.037621837114, 1152.179214194081, 1155.320806552661,
    1158.462398912841, 1161.603991274608, 1164.745583637949, 1167.887176002851,
    1171.028768369303, 1174.170360737291, 1177.311953106804, 1180.453545477828,
    1183.595137850353, 1186.736730224365, 1189.878322599854, 1193.019914976808,
    1196.161507355214, 1199.303099735062, 1202.444692116341, 1205.586284499039,
    1208.727876883145, 1211.869469268648, 1215.011061655538, 1218.152654043803,
    1221.294246433433, 1224.435838824418, 1227.577431216747, 1230.71902361041,
    1233.860616005396, 1237.002208401696, 1240.143800799299, 1243.285393198197,
    1246.426985598377, 1249.568577999833, 1252.710170402552, 1255.851762806527,
    1258.993355211748, 1262.134947618205, 1265.27654002589,  1268.418132434792,
    1271.559724844903, 1274.701317256215, 1277.842909668718, 1280.984502082403,
    1284.126094497263, 1287.267686913287, 1290.409279330469, 1293.550871748798,
    1296.692464168268, 1299.834056588869, 1302.975649010594, 1306.117241433434,
    1309.258833857381, 1312.400426282428, 1315.542018708567, 1318.683611135789,
    1321.825203564088, 1324.966795993454, 1328.108388423881, 1331.249980855362,
    1334.391573287889, 1337.533165721454, 1340.67475815605,  1343.81635059167,
    1346.957943028307, 1350.099535465954, 1353.241127904603, 1356.382720344247,
    1359.524312784881, 1362.665905226497, 1365.807497669087, 1368.949090112646,
    1372.090682557167, 1375.232275002644, 1378.373867449068, 1381.515459896435,
    1384.657052344738, 1387.79864479397,  1390.940237244125, 1394.081829695198,
    1397.223422147181, 1400.365014600068, 1403.506607053854, 1406.648199508532,
    1409.789791964097, 1412.931384420543, 1416.072976877863, 1419.214569336052,
    1422.356161795105, 1425.497754255015, 1428.639346715776, 1431.780939177384,
    1434.922531639833, 1438.064124103116, 1441.20571656723,  1444.347309032167,
    1447.488901497924, 1450.630493964494, 1453.772086431872, 1456.913678900054,
    1460.055271369033, 1463.196863838805, 1466.338456309365, 1469.480048780707,
    1472.621641252827, 1475.763233725719, 1478.904826199379, 1482.046418673802,
    1485.188011148983, 1488.329603624917, 1491.4711961016,   1494.612788579026,
    1497.754381057191, 1500.895973536091, 1504.037566015721, 1507.179158496075,
    1510.320750977151, 1513.462343458942, 1516.603935941445, 1519.745528424656,
    1522.88712090857,  1526.028713393182, 1529.170305878488, 1532.311898364485,
    1535.453490851167, 1538.595083338531, 1541.736675826573, 1544.878268315287,
    1548.019860804671, 1551.16145329472,  1554.30304578543,  1557.444638276797,
    1560.586230768818, 1563.727823261487, 1566.869415754802, 1570.011008248759,
    1573.152600743352, 1576.29419323858,  1579.435785734438, 1582.577378230921,
    1585.718970728028, 1588.860563225753, 1592.002155724093, 1595.143748223045,
    1598.285340722605, 1601.426933222769, 1604.568525723534, 1607.710118224896,
    1610.851710726852, 1613.993303229398, 1617.134895732531, 1620.276488236248,
    1623.418080740544, 1626.559673245417, 1629.701265750864, 1632.842858256881,
    1635.984450763464, 1639.126043270611, 1642.267635778318, 1645.409228286583,
    1648.550820795401, 1651.69241330477,  1654.834005814686, 1657.975598325147,
    1661.11719083615,  1664.25878334769,  1667.400375859766, 1670.541968372375,
    1673.683560885512, 1676.825153399176, 1679.966745913363, 1683.108338428071,
    1686.249930943295, 1689.391523459035, 1692.533115975286, 1695.674708492047,
    1698.816301009313, 1701.957893527082, 1705.099486045352, 1708.24107856412,
    1711.382671083383, 1714.524263603138, 1717.665856123383, 1720.807448644114,
    1723.94904116533,  1727.090633687027, 1730.232226209204, 1733.373818731856,
    1736.515411254983, 1739.65700377858,  1742.798596302646, 1745.940188827179,
    1749.081781352175, 1752.223373877632, 1755.364966403547, 1758.506558929919,
    1761.648151456745, 1764.789743984022, 1767.931336511748, 1771.07292903992,
    1774.214521568537, 1777.356114097595, 1780.497706627093, 1783.639299157028,
    1786.780891687398, 1789.9224842182,   1793.064076749432, 1796.205669281093,
    1799.347261813179, 1802.488854345689, 1805.63044687862,  1808.772039411971,
    1811.913631945738, 1815.05522447992,  1818.196817014515, 1821.33840954952,
    1824.480002084934, 1827.621594620754, 1830.763187156978, 1833.904779693604,
    1837.04637223063,  1840.187964768054, 1843.329557305875, 1846.471149844089,
    1849.612742382695, 1852.754334921691, 1855.895927461075, 1859.037520000845,
    1862.179112540999, 1865.320705081535, 1868.462297622451, 1871.603890163746,
    1874.745482705417, 1877.887075247462, 1881.02866778988,  1884.170260332669,
    1887.311852875826, 1890.453445419351, 1893.595037963241, 1896.736630507494,
    1899.878223052109, 1903.019815597083, 1906.161408142416, 1909.303000688105,
    1912.444593234148, 1915.586185780544, 1918.727778327291, 1921.869370874388,
    1925.010963421832, 1928.152555969622, 1931.294148517756, 1934.435741066233,
    1937.57733361505,  1940.718926164207, 1943.860518713701, 1947.002111263531,
    1950.143703813696, 1953.285296364193, 1956.426888915021, 1959.568481466179,
    1962.710074017665, 1965.851666569477, 1968.993259121614, 1972.134851674074,
    1975.276444226856, 1978.418036779957, 1981.559629333378, 1984.701221887116,
    1987.842814441169, 1990.984406995536, 1994.125999550216, 1997.267592105208,
    2000.409184660508, 2003.550777216117, 2006.692369772033, 2009.833962328255,
    2012.97555488478,  2016.117147441607, 2019.258739998736, 2022.400332556165,
    2025.541925113891, 2028.683517671915, 2031.825110230234, 2034.966702788847,
    2038.108295347753, 2041.249887906951, 2044.391480466439, 2047.533073026215,
    2050.674665586279, 2053.816258146629, 2056.957850707264, 2060.099443268182,
    2063.241035829383, 2066.382628390864, 2069.524220952625, 2072.665813514664,
    2075.807406076981, 2078.948998639573, 2082.09059120244,  2085.232183765581,
    2088.373776328994, 2091.515368892677, 2094.65696145663,  2097.798554020851,
    2100.940146585341, 2104.081739150095, 2107.223331715115, 2110.364924280399,
    2113.506516845945, 2116.648109411752, 2119.78970197782,  2122.931294544147,
    2126.072887110731, 2129.214479677572, 2132.356072244669, 2135.497664812021,
    2138.639257379625, 2141.780849947482, 2144.92244251559,  2148.064035083949,
    2151.205627652555, 2154.34722022141,  2157.488812790512, 2160.63040535986,
    2163.771997929452, 2166.913590499287, 2170.055183069365, 2173.196775639685,
    2176.338368210244, 2179.479960781044, 2182.621553352082, 2185.763145923357,
    2188.904738494868, 2192.046331066614, 2195.187923638595, 2198.329516210809,
    2201.471108783255, 2204.612701355933, 2207.754293928841, 2210.895886501978,
    2214.037479075343, 2217.179071648936, 2220.320664222755, 2223.462256796799,
    2226.603849371068, 2229.745441945561, 2232.887034520276, 2236.028627095213,
    2239.17021967037,  2242.311812245747, 2245.453404821344, 2248.594997397157,
    2251.736589973189, 2254.878182549436, 2258.019775125898, 2261.161367702575,
    2264.302960279465, 2267.444552856567, 2270.586145433881, 2273.727738011407,
    2276.869330589142, 2280.010923167086, 2283.152515745238, 2286.294108323597,
    2289.435700902163, 2292.577293480935, 2295.718886059911, 2298.860478639092,
    2302.002071218475, 2305.143663798061, 2308.285256377848, 2311.426848957835,
    2314.568441538023, 2317.71003411841,  2320.851626698994, 2323.993219279776,
    2327.134811860755, 2330.276404441929, 2333.417997023299, 2336.559589604862,
    2339.701182186619, 2342.842774768569, 2345.984367350711, 2349.125959933043,
    2352.267552515566, 2355.409145098279, 2358.55073768118,  2361.692330264269,
    2364.833922847547, 2367.97551543101,  2371.117108014659, 2374.258700598493,
    2377.400293182512, 2380.541885766714, 2383.683478351099, 2386.825070935667,
    2389.966663520415, 2393.108256105344, 2396.249848690454, 2399.391441275743,
    2402.533033861211, 2405.674626446856, 2408.816219032679, 2411.957811618678,
    2415.099404204853, 2418.240996791203, 2421.382589377728, 2424.524181964426,
    2427.665774551298, 2430.807367138342, 2433.948959725558, 2437.090552312945,
    2440.232144900502, 2443.373737488229, 2446.515330076126, 2449.65692266419,
    2452.798515252423, 2455.940107840823, 2459.081700429389, 2462.223293018122,
    2465.36488560702,  2468.506478196082, 2471.648070785308, 2474.789663374698,
    2477.931255964251, 2481.072848553966, 2484.214441143842, 2487.356033733879,
    2490.497626324077, 2493.639218914434, 2496.780811504951, 2499.922404095626,
    2503.063996686459, 2506.205589277449, 2509.347181868596, 2512.488774459899,
    2515.630367051358, 2518.771959642972, 2521.91355223474,  2525.055144826661,
    2528.196737418737, 2531.338330010965, 2534.479922603345, 2537.621515195876,
    2540.763107788559, 2543.904700381392, 2547.046292974375, 2550.187885567507,
    2553.329478160788, 2556.471070754217, 2559.612663347794, 2562.754255941518,
    2565.895848535389, 2569.037441129406, 2572.179033723567, 2575.320626317875,
    2578.462218912327, 2581.603811506922, 2584.745404101661, 2587.886996696543,
    2591.028589291567, 2594.170181886733, 2597.311774482041, 2600.453367077489,
    2603.594959673077, 2606.736552268806, 2609.878144864674, 2613.01973746068,
    2616.161330056825, 2619.302922653107, 2622.444515249527, 2625.586107846084,
    2628.727700442777, 2631.869293039606, 2635.01088563657,  2638.152478233669,
    2641.294070830902, 2644.435663428269, 2647.57725602577,  2650.718848623404,
    2653.86044122117,  2657.002033819068, 2660.143626417098, 2663.285219015259,
    2666.42681161355,  2669.568404211972, 2672.709996810523, 2675.851589409203,
    2678.993182008013, 2682.13477460695,  2685.276367206016, 2688.417959805209,
    2691.559552404528, 2694.701145003975, 2697.842737603547, 2700.984330203246,
    2704.125922803069, 2707.267515403018, 2710.40910800309,  2713.550700603286,
    2716.692293203606, 2719.833885804049, 2722.975478404615, 2726.117071005303,
    2729.258663606112, 2732.400256207044, 2735.541848808095, 2738.683441409268,
    2741.825034010561, 2744.966626611973, 2748.108219213505, 2751.249811815155,
    2754.391404416924, 2757.532997018811, 2760.674589620816, 2763.816182222938,
    2766.957774825177, 2770.099367427532, 2773.240960030003, 2776.382552632591,
    2779.524145235293, 2782.665737838111, 2785.807330441042, 2788.948923044088,
    2792.090515647248, 2795.232108250521, 2798.373700853907, 2801.515293457406,
    2804.656886061016, 2807.798478664739, 2810.940071268573, 2814.081663872519,
    2817.223256476575, 2820.364849080741, 2823.506441685017, 2826.648034289403,
    2829.789626893898, 2832.931219498502, 2836.072812103215, 2839.214404708036,
    2842.355997312965, 2845.497589918,    2848.639182523144, 2851.780775128393,
    2854.92236773375,  2858.063960339212, 2861.20555294478,  2864.347145550453,
    2867.488738156231, 2870.630330762114, 2873.771923368101, 2876.913515974193,
    2880.055108580388, 2883.196701186685, 2886.338293793087, 2889.47988639959,
    2892.621479006196, 2895.763071612904, 2898.904664219714, 2902.046256826624,
    2905.187849433636, 2908.329442040749, 2911.471034647961, 2914.612627255274,
    2917.754219862686, 2920.895812470198, 2924.037405077809, 2927.178997685518,
    2930.320590293325, 2933.462182901231, 2936.603775509235, 2939.745368117336,
    2942.886960725534, 2946.028553333829, 2949.17014594222,  2952.311738550708,
    2955.453331159291, 2958.594923767971, 2961.736516376745, 2964.878108985614,
    2968.019701594578, 2971.161294203636, 2974.302886812789, 2977.444479422035,
    2980.586072031375, 2983.727664640808, 2986.869257250333, 2990.010849859952,
    2993.152442469662, 2996.294035079465, 2999.43562768936,  3002.577220299345,
    3005.718812909422, 3008.86040551959,  3012.001998129848, 3015.143590740197,
    3018.285183350636, 3021.426775961164, 3024.568368571782, 3027.709961182489,
    3030.851553793285, 3033.99314640417,  3037.134739015143, 3040.276331626204,
    3043.417924237353, 3046.559516848589, 3049.701109459913, 3052.842702071323,
    3055.984294682821, 3059.125887294404, 3062.267479906075, 3065.40907251783,
    3068.550665129672, 3071.692257741599, 3074.833850353611, 3077.975442965708,
    3081.11703557789,  3084.258628190155, 3087.400220802505, 3090.541813414939,
    3093.683406027457, 3096.824998640057, 3099.966591252742, 3103.108183865508,
    3106.249776478357, 3109.391369091289, 3112.532961704303, 3115.674554317398,
    3118.816146930576, 3121.957739543834, 3125.099332157173, 3128.240924770594,
    3131.382517384095, 3134.524109997676, 3137.665702611337, 3140.807295225079};

  const std::vector<double> j1Zeros{3.831705970207512, 7.015586669815619, 10.17346813506272, 13.32369193631422,
          16.47063005087763, 19.61585851046824, 22.76008438059277, 25.90367208761838,
          29.04682853491686, 32.18967991097441, 35.33230755008387, 38.47476623477161,
          41.61709421281445, 44.75931899765282, 47.90146088718545, 51.04353518357151,
          54.18555364106132, 57.32752543790101, 60.46945784534749, 63.61135669848123,
          66.75322673409849, 69.89507183749578, 73.03689522557383, 76.17869958464146,
          79.3204871754763, 82.46225991437356, 85.60401943635023, 88.7457671449263,
          91.88750425169499, 95.0292318080447, 98.17095073079078, 101.3126618230387,
          104.4543657912828, 107.5960632595092, 110.7377547808992, 113.879440847595,
          117.0211218988924, 120.162798328149, 123.3044704886357, 126.4461386985166,
          129.587803245104, 132.7294643885096, 135.871122364789, 139.0127773886597,
          142.154429655859, 145.2960793451959, 148.4377266203422, 151.5793716314014,
          154.7210145162859, 157.8626554019303, 161.004294405362, 164.1459316346496,
          167.2875671897441, 170.4292011632266, 173.5708336409759, 176.7124647027638,
          179.8540944227884, 182.995722870153, 186.1373501092955, 189.278976200376,
          192.4206011996257, 195.5622251596626, 198.703848129777, 201.8454701561909,
          204.9870912822923, 208.12871154885, 211.2703309942078, 214.411949654462,
          217.5535675636242, 220.6951847537694, 223.8368012551717, 226.9784170964295,
          230.1200323045791, 233.2616469052006, 236.4032609225143, 239.5448743794699,
          242.6864872978287, 245.8280996982398, 248.9697116003099, 252.1113230226686,
          255.2529339830281, 258.3945444982395, 261.536154584344, 264.6777642566215,
          267.8193735296346, 270.9609824172707, 274.1025909327807, 277.2441990888146,
          280.3858068974556, 283.5274143702514, 286.6690215182434, 289.8106283519944,
          292.9522348816139, 296.0938411167825, 299.2354470667742, 302.3770527404775,
          305.5186581464156, 308.6602632927644, 311.8018681873705, 314.9434728377672,
          318.0850772511903, 321.2266814345928, 324.3682853946578, 327.5098891378125,
          330.6514926702394, 333.7930959978885, 336.934699126488, 340.0763020615541,
          343.2179048084012, 346.359507372151, 349.5011097577409, 352.6427119699324,
          355.7843140133188, 358.9259158923327, 362.0675176112526, 365.2091191742101,
          368.3507205851957, 371.4923218480648, 374.6339229665437, 377.7755239442346,
          380.9171247846209, 384.0587254910721, 387.2003260668482, 390.3419265151044,
          393.4835268388949, 396.6251270411776, 399.7667271248168, 402.908327092588,
          406.0499269471804, 409.191526691201, 412.333126327177, 415.4747258575594,
          418.6163252847255, 421.7579246109818, 424.8995238385667, 428.0411229696526,
          431.1827220063489, 434.3243209507037, 437.4659198047066, 440.6075185702902,
          443.7491172493322, 446.890715843658, 450.0323143550416, 453.1739127852081,
          456.3155111358349, 459.4571094085535, 462.5987076049513, 465.7403057265727,
          468.8819037749206, 472.0235017514582, 475.1650996576097, 478.3066974947622,
          481.4482952642663, 484.5898929674376, 487.731490605558, 490.8730881798765,
          494.0146856916102, 497.1562831419457, 500.2978805320395, 503.4394778630194,
          506.5810751359852, 509.7226723520096, 512.8642695121389, 516.0058666173942,
          519.1474636687715, 522.2890606672431, 525.4306576137581, 528.5722545092428,
          531.7138513546017, 534.8554481507182, 537.9970448984548, 541.1386415986541,
          544.2802382521394, 547.4218348597149, 550.5634314221664, 553.7050279402621,
          556.8466244147527, 559.9882208463721, 563.1298172358377, 566.2714135838512,
          569.4130098910987, 572.5546061582511, 575.6962023859651, 578.8377985748825,
          581.9793947256318, 585.1209908388277, 588.2625869150719, 591.4041829549533,
          594.5457789590482, 597.687374927921, 600.8289708621243, 603.9705667621989,
          607.1121626286747, 610.2537584620707, 613.395354262895, 616.5369500316456,
          619.6785457688103, 622.8201414748671, 625.9617371502843, 629.1033327955211,
          632.2449284110271, 635.3865239972436, 638.5281195546027, 641.6697150835282,
          644.811310584436, 647.9529060577335, 651.0945015038201, 654.2360969230882,
          657.377692315922, 660.5192876826989, 663.6608830237888, 666.8024783395548,
          669.944073630353, 673.0856688965334, 676.2272641384387, 679.3688593564059,
          682.5104545507655, 685.652049721842, 688.7936448699539, 691.9352399954142,
          695.0768350985298, 698.2184301796026, 701.3600252389285, 704.5016202767986,
          707.6432152934987, 710.7848102893092, 713.9264052645063, 717.0680002193608,
          720.2095951541387, 723.3511900691018, 726.492784964507, 729.634379840607,
          732.7759746976502, 735.9175695358806, 739.059164355538, 742.2007591568583,
          745.3423539400735, 748.4839487054114, 751.6255434530963, 754.7671381833486,
          757.908732896385, 761.0503275924187, 764.1919222716595, 767.3335169343136,
          770.4751115805839, 773.6167062106699, 776.7583008247682, 779.8998954230718,
          783.0414900057709, 786.1830845730526, 789.3246791251008, 792.4662736620969,
          795.6078681842191, 798.749462691643, 801.8910571845412, 805.0326516630838,
          808.1742461274383, 811.3158405777693, 814.4574350142394, 817.5990294370082,
          820.740623846233, 823.8822182420688, 827.0238126246682, 830.1654069941815,
          833.3070013507564, 836.4485956945391, 839.590190025673, 842.7317843442996,
          845.8733786505583, 849.0149729445862, 852.1565672265189, 855.2981614964892,
          858.439755754629, 861.5813500010672, 864.7229442359318, 867.8645384593481,
          871.0061326714402, 874.1477268723302, 877.2893210621382, 880.4309152409832,
          883.5725094089818, 886.7141035662494, 889.8556977128998, 892.9972918490448,
          896.1388859747951, 899.2804800902596, 902.4220741955457, 905.5636682907593,
          908.7052623760048, 911.8468564513855, 914.9884505170027, 918.1300445729568,
          921.2716386193466, 924.4132326562695, 927.5548266838221, 930.6964207020987,
          933.8380147111934, 936.9796087111984, 940.1212027022046, 943.2627966843023,
          946.4043906575801, 949.5459846221253, 952.6875785780245, 955.829172525363,
          958.9707664642248, 962.1123603946929, 965.2539543168494, 968.3955482307753,
          971.5371421365501, 974.6787360342528, 977.8203299239613, 980.9619238057522,
          984.1035176797014, 987.245111545884, 990.3867054043735, 993.5282992552433,
          996.669893098565, 999.8114869344101, 1002.953080762849, 1006.09467458395,
          1009.236268397783, 1012.377862204415, 1015.519456003914, 1018.661049796344,
          1021.802643581771, 1024.944237360259, 1028.085831131873, 1031.227424896675,
          1034.369018654727, 1037.51061240609, 1040.652206150825, 1043.793799888992,
          1046.93539362065, 1050.076987345857, 1053.218581064672, 1056.36017477715,
          1059.501768483349, 1062.643362183323, 1065.78495587713, 1068.926549564821,
          1072.068143246452, 1075.209736922076, 1078.351330591744, 1081.492924255509,
          1084.634517913423, 1087.776111565535, 1090.917705211896, 1094.059298852556,
          1097.200892487564, 1100.342486116967, 1103.484079740814, 1106.625673359152,
          1109.767266972028, 1112.908860579488, 1116.050454181577, 1119.192047778342,
          1122.333641369827, 1125.475234956076, 1128.616828537133, 1131.75842211304,
          1134.900015683842, 1138.041609249579, 1141.183202810294, 1144.324796366028,
          1147.466389916823, 1150.607983462718, 1153.749577003754, 1156.89117053997,
          1160.032764071405, 1163.174357598098, 1166.315951120088, 1169.457544637412,
          1172.599138150108, 1175.740731658213, 1178.882325161763, 1182.023918660796,
          1185.165512155346, 1188.30710564545, 1191.448699131142, 1194.590292612457,
          1197.731886089431, 1200.873479562096, 1204.015073030487, 1207.156666494637,
          1210.29825995458, 1213.439853410346, 1216.58144686197, 1219.723040309483,
          1222.864633752917, 1226.006227192303, 1229.147820627672, 1232.289414059054,
          1235.431007486481, 1238.572600909983, 1241.714194329589, 1244.855787745328,
          1247.99738115723, 1251.138974565324, 1254.280567969638, 1257.422161370201,
          1260.563754767041, 1263.705348160186, 1266.846941549662, 1269.988534935498,
          1273.13012831772, 1276.271721696354, 1279.413315071429, 1282.554908442968,
          1285.696501810999, 1288.838095175547, 1291.979688536637, 1295.121281894296,
          1298.262875248546, 1301.404468599414, 1304.546061946923, 1307.687655291099,
          1310.829248631964, 1313.970841969543, 1317.112435303858, 1320.254028634934,
          1323.395621962794, 1326.53721528746, 1329.678808608955, 1332.820401927301,
          1335.961995242521, 1339.103588554636, 1342.245181863669, 1345.38677516964,
          1348.528368472573, 1351.669961772486, 1354.811555069402, 1357.953148363342,
          1361.094741654325, 1364.236334942373, 1367.377928227506, 1370.519521509743,
          1373.661114789105, 1376.802708065611, 1379.94430133928, 1383.085894610133,
          1386.227487878188, 1389.369081143464, 1392.510674405981, 1395.652267665755,
          1398.793860922807, 1401.935454177154, 1405.077047428815, 1408.218640677808,
          1411.360233924149, 1414.501827167858, 1417.643420408951, 1420.785013647446,
          1423.926606883361, 1427.068200116711, 1430.209793347514, 1433.351386575787,
          1436.492979801546, 1439.634573024809, 1442.77616624559, 1445.917759463907,
          1449.059352679775, 1452.20094589321, 1455.342539104228, 1458.484132312844,
          1461.625725519075, 1464.767318722935, 1467.90891192444, 1471.050505123605,
          1474.192098320444, 1477.333691514973, 1480.475284707206, 1483.616877897158,
          1486.758471084843, 1489.900064270275, 1493.04165745347, 1496.18325063444,
          1499.324843813201, 1502.466436989765, 1505.608030164147, 1508.74962333636,
          1511.891216506417, 1515.032809674333, 1518.17440284012, 1521.315996003792,
          1524.457589165361, 1527.599182324841, 1530.740775482244, 1533.882368637584,
          1537.023961790872, 1540.165554942123, 1543.307148091346, 1546.448741238557,
          1549.590334383765, 1552.731927526984, 1555.873520668227, 1559.015113807503,
          1562.156706944826, 1565.298300080208, 1568.439893213659, 1571.581486345192,
          1574.723079474818, 1577.864672602548, 1581.006265728394, 1584.147858852367,
          1587.289451974478, 1590.431045094738, 1593.572638213158, 1596.714231329748,
          1599.855824444521, 1602.997417557486, 1606.139010668653, 1609.280603778034,
          1612.42219688564, 1615.563789991479, 1618.705383095563, 1621.846976197901,
          1624.988569298505, 1628.130162397383, 1631.271755494546, 1634.413348590004,
          1637.554941683767, 1640.696534775844, 1643.838127866245, 1646.979720954979,
          1650.121314042057, 1653.262907127487, 1656.404500211279, 1659.546093293442,
          1662.687686373986, 1665.829279452919, 1668.970872530251, 1672.112465605991,
          1675.254058680147, 1678.395651752729, 1681.537244823746, 1684.678837893206,
          1687.820430961117, 1690.962024027489, 1694.10361709233, 1697.245210155648,
          1700.386803217453, 1703.528396277752, 1706.669989336553, 1709.811582393866,
          1712.953175449698, 1716.094768504056, 1719.236361556951, 1722.377954608388,
          1725.519547658377, 1728.661140706925, 1731.80273375404, 1734.944326799731,
          1738.085919844003, 1741.227512886866, 1744.369105928326, 1747.510698968392,
          1750.652292007071, 1753.793885044371, 1756.935478080298, 1760.07707111486,
          1763.218664148064, 1766.360257179919, 1769.50185021043, 1772.643443239605,
          1775.785036267451, 1778.926629293976, 1782.068222319185, 1785.209815343086,
          1788.351408365687, 1791.493001386993, 1794.634594407012, 1797.77618742575,
          1800.917780443214, 1804.059373459411, 1807.200966474347, 1810.342559488029,
          1813.484152500464, 1816.625745511657, 1819.767338521616, 1822.908931530346,
          1826.050524537854, 1829.192117544147, 1832.33371054923, 1835.47530355311,
          1838.616896555793, 1841.758489557285, 1844.900082557592, 1848.04167555672,
          1851.183268554676, 1854.324861551464, 1857.466454547092, 1860.608047541564,
          1863.749640534888, 1866.891233527068, 1870.03282651811, 1873.174419508021,
          1876.316012496805, 1879.457605484469, 1882.599198471017, 1885.740791456457,
          1888.882384440792, 1892.023977424029, 1895.165570406173, 1898.30716338723,
          1901.448756367205, 1904.590349346102, 1907.731942323929, 1910.873535300689,
          1914.015128276389, 1917.156721251032, 1920.298314224626, 1923.439907197174,
          1926.581500168681, 1929.723093139154, 1932.864686108597, 1936.006279077014,
          1939.147872044411, 1942.289465010793, 1945.431057976165, 1948.572650940532,
          1951.714243903898, 1954.855836866268, 1957.997429827648, 1961.139022788041,
          1964.280615747453, 1967.422208705889, 1970.563801663352, 1973.705394619848,
          1976.846987575381, 1979.988580529957, 1983.130173483578, 1986.271766436251,
          1989.413359387978, 1992.554952338766, 1995.696545288618, 1998.838138237539,
          2001.979731185533, 2005.121324132604, 2008.262917078757, 2011.404510023996,
          2014.546102968326, 2017.68769591175, 2020.829288854273, 2023.970881795899,
          2027.112474736632, 2030.254067676477, 2033.395660615437, 2036.537253553516,
          2039.67884649072, 2042.820439427051, 2045.962032362513, 2049.103625297112,
          2052.24521823085, 2055.386811163731, 2058.52840409576, 2061.669997026941,
          2064.811589957277, 2067.953182886772, 2071.09477581543, 2074.236368743254,
          2077.37796167025, 2080.519554596419, 2083.661147521767, 2086.802740446296,
          2089.944333370011, 2093.085926292916, 2096.227519215012, 2099.369112136305,
          2102.510705056799, 2105.652297976495, 2108.793890895399, 2111.935483813514,
          2115.077076730842, 2118.218669647389, 2121.360262563156, 2124.501855478149,
          2127.643448392369, 2130.78504130582, 2133.926634218507, 2137.068227130432,
          2140.209820041598, 2143.351412952009, 2146.493005861669, 2149.634598770579,
          2152.776191678745, 2155.91778458617, 2159.059377492855, 2162.200970398804,
          2165.342563304022, 2168.48415620851, 2171.625749112273, 2174.767342015312,
          2177.908934917632, 2181.050527819236, 2184.192120720126, 2187.333713620305,
          2190.475306519778, 2193.616899418546, 2196.758492316612, 2199.900085213981,
          2203.041678110654, 2206.183271006635, 2209.324863901927, 2212.466456796532,
          2215.608049690454, 2218.749642583695, 2221.891235476258, 2225.032828368147,
          2228.174421259363, 2231.316014149911, 2234.457607039792, 2237.59919992901,
          2240.740792817567, 2243.882385705466, 2247.023978592709, 2250.165571479301,
          2253.307164365242, 2256.448757250537, 2259.590350135188, 2262.731943019196,
          2265.873535902566, 2269.0151287853, 2272.156721667399, 2275.298314548868,
          2278.439907429709, 2281.581500309923, 2284.723093189515, 2287.864686068486,
          2291.006278946838, 2294.147871824575, 2297.289464701699, 2300.431057578212,
          2303.572650454118, 2306.714243329418, 2309.855836204114, 2312.997429078211,
          2316.139021951708, 2319.280614824611, 2322.422207696919, 2325.563800568637,
          2328.705393439767, 2331.84698631031, 2334.988579180269, 2338.130172049648,
          2341.271764918446, 2344.413357786668, 2347.554950654316, 2350.696543521392,
          2353.838136387897, 2356.979729253835, 2360.121322119208, 2363.262914984017,
          2366.404507848266, 2369.546100711957, 2372.68769357509, 2375.82928643767,
          2378.970879299698, 2382.112472161175, 2385.254065022106, 2388.39565788249,
          2391.537250742332, 2394.678843601633, 2397.820436460394, 2400.962029318619,
          2404.103622176308, 2407.245215033465, 2410.386807890091, 2413.528400746189,
          2416.66999360176, 2419.811586456807, 2422.953179311331, 2426.094772165335,
          2429.23636501882, 2432.377957871789, 2435.519550724244, 2438.661143576187,
          2441.802736427619, 2444.944329278542, 2448.08592212896, 2451.227514978872,
          2454.369107828282, 2457.510700677191, 2460.652293525602, 2463.793886373516,
          2466.935479220935, 2470.077072067861, 2473.218664914295, 2476.360257760241,
          2479.501850605699, 2482.643443450671, 2485.785036295159, 2488.926629139166,
          2492.068221982693, 2495.209814825741, 2498.351407668313, 2501.49300051041,
          2504.634593352034, 2507.776186193187, 2510.917779033871, 2514.059371874087,
          2517.200964713837, 2520.342557553124, 2523.484150391948, 2526.625743230311,
          2529.767336068215, 2532.908928905662, 2536.050521742654, 2539.192114579192,
          2542.333707415277, 2545.475300250912, 2548.616893086099, 2551.758485920838,
          2554.900078755132, 2558.041671588982, 2561.183264422389, 2564.324857255357,
          2567.466450087884, 2570.608042919975, 2573.74963575163, 2576.891228582851,
          2580.032821413639, 2583.174414243996, 2586.316007073924, 2589.457599903424,
          2592.599192732497, 2595.740785561146, 2598.882378389372, 2602.023971217176,
          2605.165564044559, 2608.307156871524, 2611.448749698072, 2614.590342524204,
          2617.731935349922, 2620.873528175228, 2624.015121000122, 2627.156713824606,
          2630.298306648683, 2633.439899472352, 2636.581492295617, 2639.723085118477,
          2642.864677940935, 2646.006270762992, 2649.147863584649, 2652.289456405909,
          2655.431049226771, 2658.572642047238, 2661.714234867312, 2664.855827686993,
          2667.997420506282, 2671.139013325182, 2674.280606143693, 2677.422198961818,
          2680.563791779557, 2683.705384596911, 2686.846977413882, 2689.988570230472,
          2693.130163046681, 2696.271755862512, 2699.413348677965, 2702.554941493042,
          2705.696534307744, 2708.838127122071, 2711.979719936027, 2715.121312749611,
          2718.262905562826, 2721.404498375672, 2724.546091188151, 2727.687684000264,
          2730.829276812012, 2733.970869623396, 2737.112462434419, 2740.25405524508,
          2743.395648055382, 2746.537240865325, 2749.67883367491, 2752.82042648414,
          2755.962019293015, 2759.103612101537, 2762.245204909706, 2765.386797717523,
          2768.528390524991, 2771.66998333211, 2774.811576138881, 2777.953168945306,
          2781.094761751385, 2784.236354557121, 2787.377947362513, 2790.519540167564,
          2793.661132972273, 2796.802725776644, 2799.944318580676, 2803.085911384371,
          2806.22750418773, 2809.369096990753, 2812.510689793443, 2815.6522825958,
          2818.793875397826, 2821.935468199521, 2825.077061000887, 2828.218653801924,
          2831.360246602635, 2834.501839403018, 2837.643432203078, 2840.785025002813,
          2843.926617802225, 2847.068210601316, 2850.209803400085, 2853.351396198535,
          2856.492988996667, 2859.63458179448, 2862.776174591977, 2865.917767389159,
          2869.059360186026, 2872.20095298258, 2875.342545778822, 2878.484138574751,
          2881.625731370371, 2884.767324165682, 2887.908916960684, 2891.050509755378,
          2894.192102549766, 2897.333695343849, 2900.475288137628, 2903.616880931103,
          2906.758473724276, 2909.900066517147, 2913.041659309719, 2916.183252101991,
          2919.324844893963, 2922.466437685639, 2925.608030477018, 2928.749623268102,
          2931.891216058891, 2935.032808849386, 2938.174401639588, 2941.315994429498,
          2944.457587219118, 2947.599180008448, 2950.740772797488, 2953.882365586241,
          2957.023958374706, 2960.165551162885, 2963.307143950778, 2966.448736738388,
          2969.590329525714, 2972.731922312757, 2975.873515099518, 2979.015107885998,
          2982.156700672198, 2985.298293458119, 2988.439886243762, 2991.581479029128,
          2994.723071814217, 2997.864664599031, 3001.006257383569, 3004.147850167834,
          3007.289442951826, 3010.431035735546, 3013.572628518994, 3016.714221302172,
          3019.855814085081, 3022.99740686772, 3026.138999650092, 3029.280592432196,
          3032.422185214034, 3035.563777995607, 3038.705370776915, 3041.846963557959,
          3044.988556338741, 3048.13014911926, 3051.271741899518, 3054.413334679515,
          3057.554927459252, 3060.69652023873, 3063.838113017951, 3066.979705796914,
          3070.12129857562, 3073.262891354071, 3076.404484132266, 3079.546076910207,
          3082.687669687895, 3085.82926246533, 3088.970855242514, 3092.112448019446,
          3095.254040796127, 3098.395633572559, 3101.537226348742, 3104.678819124678,
          3107.820411900365, 3110.962004675807, 3114.103597451002, 3117.245190225952,
          3120.386783000658, 3123.52837577512, 3126.66996854934, 3129.811561323317,
          3132.953154097052, 3136.094746870548, 3139.236339643803, 3142.377932416818};

  /**
   * Helper functions
   */
  //_____________________________________________________________________________
  double psi(double const& t)
  {
    return t * tanh( M_PI * sinh(t) / 2 );
  }

  //_____________________________________________________________________________
  double psip(double const& t)
  {
    return ( M_PI * t * cosh(t) + sinh( M_PI * sinh(t) ) ) / ( 1 + cosh( M_PI * sinh(t) ) );
  }

  //_____________________________________________________________________________
  OgataQuadrature::OgataQuadrature(int const& nu, double const& CutOff, double const& h):
    _CutOff(CutOff),
    _h(h),
    _xf(j0Zeros.size()),
    _weights(j0Zeros.size())
  {
    // Run over the zeros of J and compute unscaled coordinates and
    // weights. There are 1000 precomputed zeros. This should be
    // enough for all practical applications.
    if (nu == 0)
      for (int i = 0; i < (int) j0Zeros.size(); i++)
        {
          const double jz = j0Zeros[i];
          const double z  = jz / M_PI;
          const double x  = M_PI * psi( _h * z ) / _h;
          const double w  = y0(jz) * j0(x) * psip( _h * z ) / j1(jz);
          _xf[i] = x;
          _weights[i] = M_PI * w;
        }
    else if (nu == 1)
      for (int i = 0; i < (int) j0Zeros.size(); i++)
        {
          const double jz = j1Zeros[i];
          const double z  = jz / M_PI;
          const double x  = M_PI * psi( _h * z ) / _h;
          const double w  = y1(jz) * j1(x) * psip( _h * z ) / jn(2,jz);
          _xf[i] = x;
          _weights[i] = M_PI * w;
        }
    else
      throw std::runtime_error(error("OgataQuadrature", "Value on 'nu' not available."));
  }

  //_____________________________________________________________________________
  template<typename T>
  T OgataQuadrature::transform(std::function<T(double const&)> const& func, double const& qT, int const& nmax) const
  {
    // Compute integral as a weighted sum.
    T integral = _weights[0] * func(_xf[0]/qT);
    int i;
    for (i = 1; i < std::min(nmax, (int) j0Zeros.size()); i++)
      {
        const T term = _weights[i] * func(_xf[i]/qT);

        // Break when the absolute value of the last term is less than
        // "_CutOff". This assumes that terms are increasingly
        // small. Provided that the integrand is not badly behaved,
        // this should be guaranteed by the Bessel functions
        // themselves.
        if (dabs(term) < _CutOff * dabs(integral))
          break;

        integral += term;
      }
    integral /= qT;

    // If the number of terms is equal to the size of the "j0Zeros"
    // vector give a warning.
    if (i == (int) j0Zeros.size())
      warning("OgataQuadrature", "Number of zero's available exceeded: the integration might not have converged.");

    return integral;
  }

  //_____________________________________________________________________________
  void OgataQuadrature::JnuZerosGenerator(int const&) const
  {
    std::cout << error("JnuZerosGenerator", "Function currently unavailable.") << std::endl;
  }
  /*
    //_____________________________________________________________________________
    void OgataQuadrature::JnuZerosGenerator(int const& nu) const
    {
      const int perline = 4;
      const int lines   = 250;
      const int n       = perline * lines - 1;

      std::cout << std::setprecision(16);
      std::cout << "  const std::vector<double> j" + std::to_string(nu) + "Zeros{";
      for (int i = 1; i <= n; i++)
        {
          std::cout << boost::math::cyl_bessel_j_zero((double) nu, i) << ", ";
          if (i % perline == 0)
            std::cout << std::endl << "      ";
        }
      std::cout << boost::math::cyl_bessel_j_zero((double) nu, n+1) << "};" << std::endl;
    }
  */

  // Specialisations
  template double OgataQuadrature::transform<double>(std::function<double(double const&)> const& f,
                                                     double const& qT, int const& nmax) const;
  template Distribution OgataQuadrature::transform<Distribution>(std::function<Distribution(double const&)> const& f,
                                                                 double const& qT, int const& nmax) const;
  template Set<Distribution> OgataQuadrature::transform<Set<Distribution>>(std::function<Set<Distribution>(double const&)> const& f,
                                                                           double const& qT, int const& nmax) const;
  template DoubleObject<Distribution> OgataQuadrature::transform<DoubleObject<Distribution>>(std::function<DoubleObject<Distribution>(double const&)> const& f,
                                                                                             double const& qT, int const& nmax) const;
}
